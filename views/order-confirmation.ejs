<%- include('./partials/header') %>

<style>
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

.animate-fade-in {
    animation: fadeIn 0.5s ease-out;
}

.animate-pulse-slow {
    animation: pulse 2s infinite;
}

.progress-ring circle {
    transition: stroke-dashoffset 0.3s;
}
</style>

<div class="flex-grow p-4 md:p-8" style="background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);">
    <div class="max-w-2xl w-full bg-white rounded-2xl shadow-2xl overflow-hidden animate-fade-in mx-auto">
        <!-- Header -->
        <div class="bg-gradient-to-r from-green-500 to-emerald-600 p-8 text-center">
            <div class="flex justify-center mb-6">
                <div class="w-20 h-20 rounded-full bg-white flex items-center justify-center animate-pulse-slow">
                    <i class="ri-checkbox-circle-fill text-4xl text-green-500"></i>
                </div>
            </div>
            <h1 class="text-3xl font-bold text-white mb-2">Order Confirmed!</h1>
            <p class="text-green-100 text-lg">Thank you for your purchase</p>
        </div>

        <!-- Order Details -->
        <div class="p-8">
            <div class="text-center mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Order Summary</h2>
                <div class="bg-gray-50 rounded-xl p-6 mb-6">
                    <div class="flex justify-between items-center mb-4 pb-4 border-b border-gray-200">
                        <span class="text-gray-600">Order ID:</span>
                        <span class="font-mono font-bold text-gray-900"><%= order.id %></span>
                    </div>
                    <div class="flex justify-between items-center mb-4 pb-4 border-b border-gray-200">
                        <span class="text-gray-600">Order Date:</span>
                        <span class="font-medium text-gray-900"><%= new Date(order.date).toLocaleDateString() %></span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">Total Amount:</span>
                        <span class="text-2xl font-bold text-green-600">₹<%= order.total %></span>
                    </div>
                </div>
            </div>

            <!-- Items List -->
            <div class="mb-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Items Purchased</h3>
                <div class="space-y-4">
                    <% order.items.forEach(function(item){ %>
                        <div class="flex items-center gap-4 p-4 bg-gray-50 rounded-lg">
                            <% if(item.image){ %>
                                <div class="w-16 h-16 rounded-lg overflow-hidden flex items-center justify-center" style="background-color:<%= item.bgcolor || '#f3f4f6' %>;">
                                    <img src="<%= item.image %>" alt="<%= item.name %>" class="h-12 w-auto object-contain">
                                </div>
                            <% } else { %>
                                <div class="w-16 h-16 rounded-lg bg-gray-200 flex items-center justify-center">
                                    <i class="ri-image-line text-gray-400 text-xl"></i>
                                </div>
                            <% } %>
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-900"><%= item.name %></h4>
                                <p class="text-gray-600">₹<%= item.price %></p>
                            </div>
                            <div class="text-right">
                                <span class="text-green-600 font-semibold">₹<%= (item.price - (item.discount || 0)) %></span>
                                <% if(item.discount && item.discount > 0){ %>
                                    <div class="text-sm text-gray-500 line-through">₹<%= item.price %></div>
                                <% } %>
                            </div>
                        </div>
                    <% }) %>
                </div>
            </div>

            <!-- Progress Indicator -->
            <div class="text-center mb-8">
                <div class="inline-flex items-center gap-4">
                    <div class="flex flex-col items-center">
                        <div class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center mb-2">
                            <i class="ri-checkbox-circle-fill text-white text-xl"></i>
                        </div>
                        <span class="text-sm font-medium text-green-600">Ordered</span>
                    </div>
                    <div class="w-16 h-1 bg-green-300 rounded"></div>
                    <div class="flex flex-col items-center">
                        <div class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center mb-2">
                            <i class="ri-truck-fill text-white text-xl"></i>
                        </div>
                        <span class="text-sm font-medium text-green-600">Shipped</span>
                    </div>
                    <div class="w-16 h-1 bg-green-300 rounded"></div>
                    <div class="flex flex-col items-center">
                        <div class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center mb-2">
                            <i class="ri-home-4-fill text-white text-xl"></i>
                        </div>
                        <span class="text-sm font-medium text-green-600">Delivered</span>
                    </div>
                </div>
            </div>

            <!-- Countdown Timer -->
            <div class="text-center bg-green-50 rounded-xl p-6 mb-6">
                <p class="text-gray-600 mb-2">Redirecting to homepage in</p>
                <div class="text-3xl font-bold text-green-600 mb-4" id="countdown">10</div>
                <p class="text-gray-600">seconds...</p>
            </div>

            <!-- Action Button -->
            <div class="text-center">
                <a href="/home" 
                   class="inline-block px-8 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg shadow-lg hover:from-green-600 hover:to-emerald-700 transition-all transform hover:scale-105">
                    <i class="ri-home-4-line mr-2"></i>
                    Go to Homepage Now
                </a>
            </div>
        </div>
    </div>
</div>

<script>
// Countdown timer
let countdown = 7;
const countdownElement = document.getElementById('countdown');

const timer = setInterval(() => {
    countdown--;
    countdownElement.textContent = countdown;
    
    if (countdown <= 0) {
        clearInterval(timer);
        window.location.href = '/home';
    }
}, 1000);

// Allow manual redirect
document.querySelector('a[href="/home"]').addEventListener('click', function(e) {
    clearInterval(timer);
});
</script>

<%- include('./partials/footer') %>